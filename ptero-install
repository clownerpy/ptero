#!/usr/bin/env bash
set -e

spinner() {
    local pid=$1
    local delay=0.1
    local spinstr='|/-\'
    while kill -0 $pid 2>/dev/null; do
        local temp=${spinstr#?}
        printf " [%c]  " "$spinstr"
        local spinstr=$temp${spinstr%"$temp"}
        sleep $delay
        printf "\b\b\b\b\b\b"
    done
    printf "      \b\b\b\b\b\b"
}

run_with_spinner() {
    "$@" &> /dev/null &
    spinner $!
}

while true; do
    echo "======================================="
    echo "       Pterodactyl Official Installer  "
    echo "======================================="
    echo "1) Install Pterodactyl Panel"
    echo "2) Install Pterodactyl Wing"
    echo "0) Exit"
    echo -n "Enter your choice: "
    read choice

    case $choice in
        1)
            echo "Installing Pterodactyl Panel..."
            # Official panel install script
            run_with_spinner curl -Lo panel.sh https://raw.githubusercontent.com/pterodactyl/panel/develop/install.sh
            run_with_spinner bash panel.sh
            ;;
        2)
            echo "Installing Pterodactyl Wing..."
            # Official wing install script
            run_with_spinner curl -Lo wing.sh https://raw.githubusercontent.com/pterodactyl/wing/main/install.sh
            run_with_spinner bash wing.sh
            ;;
        0)
            echo "Exiting..."
            exit 0
            ;;
        *)
            echo "Invalid choice! Please try again."
            ;;
    esac
    echo ""
done
